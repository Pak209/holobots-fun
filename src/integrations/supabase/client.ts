
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const SUPABASE_URL = "https://pfpidggrdnmfgrbncpyl.supabase.co";
const SUPABASE_PUBLISHABLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBmcGlkZ2dyZG5tZmdyYm5jcHlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA3ODM5ODcsImV4cCI6MjA1NjM1OTk4N30.fyR2E6WWCGmBTK322Tre7RRMh65I55kaPHF5RYJKGgo";

// Create the Supabase client
export const supabase = createClient<Database>(
  SUPABASE_URL, 
  SUPABASE_PUBLISHABLE_KEY,
  {
    auth: {
      autoRefreshToken: true,
      persistSession: true,
      detectSessionInUrl: false // Disable auto detection to prevent redirect issues
    },
    realtime: {
      params: {
        eventsPerSecond: 10 // Increase events per second for better realtime updates
      }
    }
  }
);

// Helper functions
export const updateHolobotExperience = (holobots: any[], holobotName: string, newExperience: number, newLevel: number) => {
  if (!holobots || !Array.isArray(holobots)) {
    return [];
  }
  
  return holobots.map(holobot => {
    if (holobot.name.toLowerCase() === holobotName.toLowerCase()) {
      return {
        ...holobot,
        level: newLevel,
        experience: newExperience,
        nextLevelExp: calculateExperience(newLevel)
      };
    }
    return holobot;
  });
};

export const calculateExperience = (level: number) => {
  const BASE_XP = 100;
  return Math.floor(BASE_XP * Math.pow(level, 2));
};

// Constants for use in other files
export const HOLOBOT_STATS = {
  MAX_LEVEL: 50,
  BASE_HEALTH: 100,
  BASE_ATTACK: 10,
  BASE_DEFENSE: 5,
  BASE_SPEED: 8
};

// Daily boss rotation function
export const getDailyBossRotation = () => {
  // Create deterministic boss rotations based on the day of the year
  const now = new Date();
  const start = new Date(now.getFullYear(), 0, 0);
  const diff = now.getTime() - start.getTime();
  const oneDay = 1000 * 60 * 60 * 24;
  const dayOfYear = Math.floor(diff / oneDay);
  
  // Use modulo to rotate through bosses
  const bossRotations = {
    tier1: [
      'ace', 'hare', 'byte', 'nova', 'zed'
    ],
    tier2: [
      'luna', 'rex', 'tsuin', 'pulse', 'grit'
    ],
    tier3: [
      'void', 'kurai', 'flux', 'neo', 'titan'
    ]
  };
  
  return {
    tier1: bossRotations.tier1[dayOfYear % bossRotations.tier1.length],
    tier2: bossRotations.tier2[dayOfYear % bossRotations.tier2.length],
    tier3: bossRotations.tier3[dayOfYear % bossRotations.tier3.length]
  };
};

// Player rank colors
export const playerRankColors = {
  Rookie: '#cccccc',
  Scout: '#4caf50',
  Champion: '#2196f3',
  Elite: '#9c27b0',
  Legend: '#ff9800',
  Mythic: '#f44336'
};

// Theme colors
export const themeColors = {
  primary: '#00E5FF',
  secondary: '#9C27B0',
  background: '#0C1218',
  backgroundLight: '#1A2836',
  text: '#FFFFFF',
  textSecondary: '#AAAAAA',
  error: '#FF3B30',
  success: '#34C759',
  warning: '#FFCC00',
  muted: '#888888'
};
